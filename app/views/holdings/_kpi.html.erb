<h1>Key Indicators</h1>

<% array = [] %>
<% @holdings.each do |holding| %>
<% array << holding.dollar_value %>
<% end %>
<% assets = array.sum %>

<table class="table table-condensed table-hover">

  <thead>

  <tr>
    <th colspan = "8"></th>
    <th colspan = "3" style="text-align:center; border-bottom:1px solid;">Consensus</th>
    <th></th>
    <th colspan = "3" style="text-align:center; border-bottom:1px solid;">Internal Forecasts</th>
    <th></th>
  </tr>

  <tr>
    <th>Sector</th>
    <th>Symbol</th>
    <th>Weight</th>
    <th>Price</th>
    <th>Target</th>
    <th>Premium</th>
    <th>DPS</th>
    <th>EPS</th>
    <th>FY1 EPS</th>
    <th>FY2 EPS</th>
    <th>PEG</th>
    <th> </th>
    <th>FY1 EPS</th>
    <th>FY2 EPS</th>
    
  </tr>

  </thead>

  <tbody>

  <% @holdings.each do |holding| %>
  <tr>
    <td><%= holding.sector_name_for_holdings %></td>
    <td><%= holding.symbol %></td>
    
    <td style="text-align:right">
      <%= holding.weight(@assets) %>
    </td>
    <td style="text-align:right">
      <%= holding.indicator_currency_dec("LastTradePriceOnly") %>
    </td>
    <td style="text-align:right">
      <%= holding.our_price_target %>
    </td>
    <td style="text-align:right">
      <%= holding.premium %>
    </td>

    <%- holding.key_indicators_p_sh.each do |key| %>
      <td style="text-align:right">
        <%= holding.indicator_currency_dec(key) %>
      </td>
    <% end %>

    <td style="text-align:right">
      <%= holding.indicator_comma_dec("PEGRatio") %>
    </td>
    <td style="text-align:right"><%= holding.our_current_year_eps %></td>
    <td style="text-align:right"><%= holding.our_next_year_eps %></td>
    <td> </td>
  </tr>
  <% end %>

  <tr>
    <td><b>Total</b></td>
    <td></td>
    <td style="text-align:right"><b><%= Format.percent_dec(100) %></b></td>
    <td colspan = "11"></td>
  </tr>
  </tbody>

</table>